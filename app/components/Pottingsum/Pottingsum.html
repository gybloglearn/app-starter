<div class="container">
  <section class="module">
    <div class="module-header">
      <h1 class="text-center">{{vm.mch}}-összesítő</h1>
      <h1 class="text-center">{{vm.datumszam}}</h1>
      <hr>
      <div class="col-sm-5 col-md-4 col-md-offset-2">
        <div class="input-group">
          <span class="input-group-addon">Dátum:</span>
          <input type="text" class="datepicker form-control" ng-model="vm.datum">
        </div>
      </div>
      <div class="col-sm-5 col-md-4">
        <div class="input-group">
          <span class="input-group-addon">Potting:</span>
          <select name="" id="" class="form-control" ng-model="vm.mch" ng-change="vm.load()">
            <option value="{{mch}}" ng-repeat="mch in vm.pottings">{{mch}}</option>
          </select>
        </div>
      </div>
      <div class="col-sm-1 col-md-1">
        <div class="input-group">
          <div class="input-group-btn">
            <a href="" class="btn btn-primary" ng-click="vm.beallit();vm.load()" ng-disabled="vm.dis">Betöltés</a>
          </div>
        </div>
      </div>
    </div>
    <div class="module-body">
      <div class="progress progress-warning progress-striped active" ng-hide="!vm.dis">
        <div class="progress-bar" style="width: 100%">
          <p class="text-center">Betöltés...</p>
        </div>
      </div>

      <my-chart id="chart" config="vm.chartconfig"></my-chart>

      <div ng-show="vm.mutat">
        <div class="col-sm-12" style="margin-top:20px">
          <div class="input-group">
            <span class="input-group-addon">Név</span>
            <input type="text" class="form-control" ng-model="user.displayname" readonly>
            <span class="input-group-addon">Kezdő dátum</span>
            <input type="text" class="form-control" ng-model="vm.startinfo">
            <span class="input-group-addon">Vége dátum</span>
            <input type="text" class="form-control" ng-model="vm.endinfo">
            <span class="input-group-addon">Állomás</span>
            <select class="form-control" ng-model="vm.actplace">
              <option ng-repeat="pl in vm.hely" value="{{pl}}">{{pl}}</option>
            </select>
          </div>
          <div class="input-group" style="margin-top:20px">
            <span class="input-group-addon">Megjegyzés</span>
            <textarea class="form-control" rows="4" ng-model="vm.descriptioninfo"></textarea>
          </div>
          <div class="col-sm-4" style="margin-top:10px">
            <button class="btn btn-success" ng-click="vm.saveinfo()" ng-disabled="vm.actplace=='' || vm.descriptioninfo=='' || vm.startinfo==vm.endinfo">Feltölt</button>
            <button class="btn btn-primary" ng-click="vm.createinfodata={};vm.mutat=false">Mégse</button>
          </div>
        </div>
      </div>

      <div>
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>Szak</th>
              <th width="10%" ng-repeat="h in vm.hely">{{h}}</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <th>{{ 1 | shift:vm.datum }}</th>
              <th ng-repeat="h in vm.hely track by $index">{{(vm.chartData[$index].data | filter:{'sh':1}) | sumField:'y' | number:0}}</th>
            </tr>
            <tr ng-hide="( 2 | shift:vm.datum ) == null">
              <th>{{ 2 | shift:vm.datum }}</th>
              <th ng-repeat="h in vm.hely track by $index">{{(vm.chartData[$index].data | filter:{'sh':2}) | sumField:'y' | number:0}}</th>
            </tr>
            <tr>
              <th>{{ 3 | shift:vm.datum }}</th>
              <th ng-repeat="h in vm.hely track by $index">{{(vm.chartData[$index].data | filter:{'sh':3}) | sumField:'y' | number:0}}</th>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 class="text-center" style="cursor:pointer" data-toggle="collapse" data-target="#details">Részletek
        <i class="icon-chevron-right"></i>
      </h3>
      <div class="collapse" id="details">
        <div class="tray filter-tray top">
          <div class="tray-inner">
            <div class="filter-rule-group">

            </div>
          </div>
        </div>
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>JobID</th>
              <th>Fixture</th>
              <th>PT_Start_DT</th>
              <th>PT_GEL_PREP_DT</th>
              <th>PT_URET_PREP_A_DT</th>
              <th>PT_POST_URET_A_DT</th>
              <th>PT_ROT_DT</th>
              <th>PT_URET_PREP_F_DT</th>
              <th>PT_POST_URET_F_DT</th>
              <th>PT_OUT</th>
            </tr>
          </thead>
          <tbody>
            <tr ng-repeat="item in vm.data track by $index">
              <td><a href="../modulhistory/#/history/{{item.JobID }}" target="_blank">{{item.JobID}}</a></td>
              <td>{{item.Fixture}}</td>

              <td ng-if="vm.vege > item.PT_Start_DT && vm.kezdo <= item.PT_Start_DT">{{item.PT_Start_DT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_Start_DT || !item.PT_Start_DT" style="color:lightgrey;">{{item.PT_Start_DT | date:"MMdd HH"}}</td>

              <td ng-if="vm.vege > item.PT_GEL_PREP_DT && vm.kezdo <= item.PT_GEL_PREP_DT">{{item.PT_GEL_PREP_DT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_GEL_PREP_DT || !item.PT_GEL_PREP_DT" style="color:lightgrey;">{{item.PT_GEL_PREP_DT | date:"MMdd HH"}}</td>

              <td ng-if="vm.vege > item.PT_URET_PREP_A_DT && vm.kezdo <= item.PT_URET_PREP_A_DT">{{item.PT_URET_PREP_A_DT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_URET_PREP_A_DT || !item.PT_URET_PREP_A_DT" style="color:lightgrey;">{{item.PT_URET_PREP_A_DT | date:"MMdd HH"}}</td>

              <td ng-if="vm.vege > item.PT_POST_URET_A_DT && vm.kezdo <= item.PT_POST_URET_A_DT">{{item.PT_POST_URET_A_DT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_POST_URET_A_DT || !item.PT_POST_URET_A_DT" style="color:lightgrey;">{{item.PT_POST_URET_A_DT | date:"MMdd HH"}}</td>

              <td ng-if="vm.vege > item.PT_ROT_DT && vm.kezdo <= item.PT_ROT_DT">{{item.PT_ROT_DT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_ROT_DT || !item.PT_ROT_DT" style="color:lightgrey;">{{item.PT_ROT_DT | date:"MMdd HH"}}</td>

              <td ng-if="vm.vege > item.PT_URET_PREP_F_DT && vm.kezdo <= item.PT_URET_PREP_F_DT">{{item.PT_URET_PREP_F_DT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_URET_PREP_F_DT || !item.PT_URET_PREP_F_DT" style="color:lightgrey;">{{item.PT_URET_PREP_F_DT | date:"MMdd HH"}}</td>

              <td ng-if="vm.vege > item.PT_POST_URET_F_DT && vm.kezdo <= item.PT_POST_URET_F_DT">{{item.PT_POST_URET_F_DT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_POST_URET_F_DT || !item.PT_POST_URET_F_DT" style="color:lightgrey;">{{item.PT_POST_URET_F_DT | date:"MMdd HH"}}</td>

              <td ng-if="vm.vege > item.PT_OUT && vm.kezdo <= item.PT_OUT">{{item.PT_OUT | date:"MMdd HH"}}</td>
              <td ng-if="vm.kezdo > item.PT_OUT || !item.PT_OUT" style="color:lightgrey;">{{item.PT_OUT | date:"MMdd HH"}}</td>
            </tr>
          </tbody>
        </table>
      </div>

    </div>
    <div class="module-footer">

    </div>
  </section>
</div>

<div class="modal" id="modalT">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">×</button>
        <h3 class="modal-title">Modal Heading</h3>
      </div>
      <div class="modal-body">

      </div>
    </div>
  </div>
</div>