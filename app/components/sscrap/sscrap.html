<div class="container">
  <section class="module">
    <div class="module-header">
      <h1 class="text-center">Termelési összesítő</h1>
      <div class="col-sm-12" style="margin-top:20px">
        <div class="col-sm-6">
          <div class="input-group">
            <span class="input-group-addon">Dátum</span>
            <input type="text" class="datepicker form-control" ng-model="vm.startdate" setdate="-1d" end="{{vm.edate}}">
            <span class="input-group-addon">-tól</span>
            <input type="text" class="datepicker form-control" ng-model="vm.enddate" setdate="-1d" end="{{vm.edate}}">
            <span class="input-group-addon">-ig</span>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="input-group myselector">
            <select multiple="multiple" class="form-control" ng-model="vm.sheetmakers">
              <option value="SM1">SM1</option>
              <option value="SM2">SM2</option>
              <option value="SM4">SM4</option>
              <option value="SM5">SM5</option>
              <option value="SM6">SM6</option>
              <option value="SM7">SM7</option>
              <option value="SM8">SM8</option>
              <option value="SM9">SM9</option>
            </select>
            <span class="input-group-addon">gépek</span>
          </div>
        </div>
        <div class="col-sm-2 col-sm-offset-5 text-center">
          <a href="" class="btn btn-primary" ng-click="vm.createdate(vm.enddate)" ng-disabled="vm.enddate<vm.startdate">Betöltés</a>
        </div>
      </div>
    </div>
    <div class="module-body">
      <style>
        .green {
          background-color: rgb(0, 255, 0)
        }

        .red {
          background-color: rgb(255, 0, 0)
        }
      </style>
      <!--<div class="tray filter-tray top">
        <div class="tray-inner">
          <div class="filter-rule-group">
            <div class="col-sm-3">
              <div class="form-group">
                <span class="control-label" style="color:#FFFFFF">SM</span>
                <select ng-model="search.id" class="form-control">
                  <option value="">Mind</option>
                  <option ng-repeat="sm in vm.sheetmakers" value="{{sm}}">{{sm}}</option>
                </select>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="form-group">
                <span class="control-label" style="color:#FFFFFF">Szak</span>
                <select ng-model="search.shift" class="form-control">
                  <option value="">Mind</option>
                  <option value="A">A</option>
                  <option value="B">B</option>
                  <option value="C">C</option>
                  <option value="D">D</option>
                </select>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>-->

      <div class="row">
        <div class="col-sm-2">Nap</div>
        <div class="col-sm-1">Szak</div>
        <div class="col-sm-1">SM</div>
        <div class="col-sm-2">Típus</div>
        <div class="col-sm-2">Össz</div>
        <div class="col-sm-2">Jó</div>
        <div class="col-sm-2">Rossz</div>
      </div>
      <div class="pivot" ng-repeat="date in vm.sm | unique: 'date' | orderBy:'date' track by $index">
        <div class="row hover" ng-click="showshifts=!showshifts">
          <div class="col-sm-6">
            <h3>{{date.date}}</h3>
          </div>
          <div class="col-sm-2">{{vm.sm | filter:{date: date.date} | sumField: 'total' | number:0}}</div>
          <div class="col-sm-2">{{vm.sm | filter:{date: date.date} | sumField: 'good' | number:0}}</div>
          <div class="col-sm-2">{{vm.sm | filter:{date: date.date} | sumField: 'bad' | number:0}}</div>
        </div>
        <div ng-repeat="sh in [1,3]" ng-show="showshifts">
          <div class="row hover" ng-click="showsms=!showsms">
            <div class="col-sm-offset-2 col-sm-4">
              <h4>{{sh==1?'DE':'DU'}} - {{sh | shift:date.date}}</h4>
            </div>
            <div class="col-sm-2">{{vm.sm | filter:{date: date.date, shiftnum: sh} | sumField: 'total' | number:0}}</div>
            <div class="col-sm-2">{{vm.sm | filter:{date: date.date, shiftnum: sh} | sumField: 'good' | number:0}}</div>
            <div class="col-sm-2">{{vm.sm | filter:{date: date.date, shiftnum: sh} | sumField: 'bad' | number:0}}</div>
          </div>
          <div ng-repeat="item in ((vm.sm | filter: {date:date.date, shiftnum:sh}) | unique:'id') | orderBy:'id'" ng-show="showsms">
            <div class="row hover" ng-click="showtypes=!showtypes">
              <div class="col-sm-offset-3 col-sm-1">
                <h5>{{item.id}}</h5>
              </div>
              <div class="col-sm-2"><span ng-if="(vm.sm | filter: {date:date.date, shiftnum:sh, id:item.id}).length == 1">{{item.type}}</span></div>
              <div class="col-sm-2">{{vm.sm | filter:{id: item.id, date: date.date, shiftnum: sh} | sumField: 'total' | number:0}}</div>
              <div class="col-sm-2">{{vm.sm | filter:{id: item.id, date: date.date, shiftnum: sh} | sumField: 'good' | number:0}}</div>
              <div class="col-sm-2">{{vm.sm | filter:{id: item.id, date: date.date, shiftnum: sh} | sumField: 'bad' | number:0}}</div>
            </div>
            <div ng-if="(vm.sm | filter: {date:date.date, shiftnum:sh, id:item.id}).length > 1" class="row" ng-repeat="it in vm.sm | filter: {date: date.date, shiftnum:sh, id: item.id} | orderBy: 'type'" ng-show="showtypes">
              <div class="col-sm-4"></div>
              <div class="col-sm-2">{{it.type}}</div>
              <div class="col-sm-2">{{vm.sm | filter:{id: item.id, date: date.date, shiftnum: sh} | sumField: 'total' | number:0}}</div>
              <div class="col-sm-2">{{vm.sm | filter:{id: item.id, date: date.date, shiftnum: sh} | sumField: 'good' | number:0}}</div>
              <div class="col-sm-2">{{vm.sm | filter:{id: item.id, date: date.date, shiftnum: sh} | sumField: 'bad' | number:0}}</div>
            </div>
          </div>
        </div>
      </div>
      <!--<table class="table table-striped">
        <thead>
          <tr>
            <th>Dátum</th>
            <th>Műszak</th>
            <th>Szak</th>
            <th>SM</th>
            <th>Típus</th>
            <th>Összlap</th>
            <th>Jó lap</th>
            <th>Selejt</th>
            <th>Eltérés</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="item in vm.sm | orderBy:['date','shiftnum'] track by $index">
            <td>{{item.date}}</td>
            <td>{{item.shiftnum==1?'DE':'DU'}}</td>
            <td>{{item.shift}}</td>
            <td>{{item.id}}</td>
            <td>{{item.type}}</td>
            <td>{{item.total}}</td>
            <td>{{item.good}}</td>
            <td>{{item.bad}}</td>
            <td style="background-color:{{item.bad==item.diff?'green':'red'}}"></td>
          </tr>
        </tbody>
      </table>-->
    </div>
    <div class="module-footer"></div>
  </section>
</div>